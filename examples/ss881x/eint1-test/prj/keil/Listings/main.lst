C51 COMPILER V9.60.0.0   MAIN                                                              09/15/2021 18:08:20 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\..\src\main.c OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(..\..\inc;..\..\pr
                    -j) DEBUG PRINT(.\Listings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          /*
   2           * eint0-test.c
   3           *
   4           * EINT0 test.
   5           *
   6           * Author: lipeng<lp@sinhmicro.com>
   7           * 
   8           * Copyright (C) 2021 Sinh Micro, Inc.
   9           *
  10           * Licensed under the Apache License, Version 2.0 (the "License");
  11           * you may not use this file except in compliance with the License.
  12           * You may obtain a copy of the License at
  13           *
  14           *     http://www.apache.org/licenses/LICENSE-2.0
  15           *
  16           * Unless required by applicable law or agreed to in writing, software
  17           * distributed under the License is distributed on an "AS IS" BASIS,
  18           * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  19           * See the License for the specific language governing permissions and
  20           * limitations under the License.
  21           */
  22          
  23          #include "ss881x.h"
  24          
  25          #define EINT1_PIN_USED (0x03)   //0x03: reuse P03;  0x14: reuse P14
  26          
  27          static void _delay_ms(unsigned char ms)
  28          {       
  29   1          unsigned char i, j;
  30   1          do {
  31   2              i = 4;
  32   2              j = 200;
  33   2              do
  34   2              {
  35   3                  while (--j);
  36   3              } while (--i);
  37   2          } while (--ms);
  38   1      }
  39          
  40          
  41          #if defined(__C51__)        // keil C51 compiler
  42          void eint1_ISR(void) interrupt 2
  43          #else                       // SDCC compiler
              void eint1_ISR(void) __interrupt 2
              #endif
  46          {
  47   1          
  48   1          P0 ^= 0x01;             // P00 toggle
  49   1          
  50   1          _delay_ms(250);
  51   1          
  52   1          EINTCON &= ~0x02;       // clear IE1
  53   1      }
  54          
C51 COMPILER V9.60.0.0   MAIN                                                              09/15/2021 18:08:20 PAGE 2   

  55          int main()
  56          {
  57   1          WDTCON  = 0x05;         // disable watchdog at startup
  58   1      
  59   1          P0MOD   &= ~0x01;       // P00 as GPIO output
  60   1          P0      &= ~0x01;       // P00 output low
  61   1          
  62   1      #if (EINT1_PIN_USED == 0x03)
  63   1          MFP0    |= 0x80;        // P03 as EINT1
  64   1      #elif (EINT1_PIN_USED == 0x14)
                  MFP3    |=0x30;         // P14 as EINT1
              #endif
  67   1      
  68   1          EINTCON = 0xA0;         // EINT1 rise edge
  69   1          EX1     = 1;            // enable EINT1 IRQ
  70   1      
  71   1          EA      = 1;            // Enable global IRQ
  72   1      
  73   1          while (1) {
  74   2          }
  75   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     66    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
