C51 COMPILER V9.60.0.0   MAIN                                                              09/15/2021 17:12:16 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\..\src\main.c OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(..\..\inc;..\..\pr
                    -j) DEBUG PRINT(.\Listings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          /*
   2           * eint0-test.c
   3           *
   4           * EINT0 test.
   5           *
   6           * Author: lipeng<lp@sinhmicro.com>
   7           * 
   8           * Copyright (C) 2021 Sinh Micro, Inc.
   9           *
  10           * Licensed under the Apache License, Version 2.0 (the "License");
  11           * you may not use this file except in compliance with the License.
  12           * You may obtain a copy of the License at
  13           *
  14           *     http://www.apache.org/licenses/LICENSE-2.0
  15           *
  16           * Unless required by applicable law or agreed to in writing, software
  17           * distributed under the License is distributed on an "AS IS" BASIS,
  18           * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  19           * See the License for the specific language governing permissions and
  20           * limitations under the License.
  21           */
  22          
  23          #include "ss881x.h"
  24          
  25          #define EINT0_PIN_USED 0x04   //0x04: reuse P04;  0x10: reuse P10
  26          
  27          static void _delay_ms(unsigned char ms)
  28          {       
  29   1          unsigned char i, j;
  30   1          do {
  31   2              i = 4;
  32   2              j = 200;
  33   2              do
  34   2              {
  35   3                  while (--j);
  36   3              } while (--i);
  37   2          } while (--ms);
  38   1      }
  39          
  40          
  41          #if defined(__C51__)        // keil C51 compiler
  42          void eint0_ISR(void) interrupt 0
  43          #else                       // SDCC compiler
              void eint0_ISR(void) __interrupt 0
              #endif
  46          {
  47   1          
  48   1          P0 ^= 0x01;             // P00 toggle
  49   1          
  50   1          _delay_ms(250);
  51   1          
  52   1          EINTCON &= ~0x01;       // clear IE0
  53   1      }
  54          
C51 COMPILER V9.60.0.0   MAIN                                                              09/15/2021 17:12:16 PAGE 2   

  55          int main()
  56          {
  57   1          WDTCON  = 0x05;         // disable watchdog at startup
  58   1      
  59   1          P0MOD   &= ~0x01;       // P00 as GPIO output
  60   1          P0      &= ~0x01;       // P00 output low
  61   1          
  62   1      #if (EINT0_PIN_USED == 0x04)
  63   1          MFP1    &= ~0x03;
  64   1          MFP1    |= 0x02;        // P04 as EINT0
  65   1      #elif (EINT0_PIN_USED == 0x10)
                  MFP2    &=~0x03;
                  MFP2    |=0x02;         // P10 as EINT0
              #endif
  69   1      
  70   1          EINTCON = 0x20;         // EINT0 rise edge
  71   1          EX0     = 1;            // enable EINT0 IRQ
  72   1      
  73   1          EA      = 1;            // Enable global IRQ
  74   1      
  75   1          while (1) {
  76   2          }
  77   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     69    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
