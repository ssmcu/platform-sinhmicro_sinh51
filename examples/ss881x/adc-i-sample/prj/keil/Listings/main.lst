C51 COMPILER V9.57.0.0   MAIN                                                              11/23/2021 15:28:33 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\..\src\main.c OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(..\..\inc;..\..\pr
                    -j) DEBUG PRINT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          /*
   2           * adc-i-sample.c
   3           *
   4           * ADC test.
   5           *
   6           * Author: chenjingfan<919419355@qq.com>
   7           * 
   8           * Copyright (C) 2021 Sinh Micro, Inc.
   9           *
  10           * Licensed under the Apache License, Version 2.0 (the "License");
  11           * you may not use this file except in compliance with the License.
  12           * You may obtain a copy of the License at
  13           *
  14           *     http://www.apache.org/licenses/LICENSE-2.0
  15           *
  16           * Unless required by applicable law or agreed to in writing, software
  17           * distributed under the License is distributed on an "AS IS" BASIS,
  18           * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  19           * See the License for the specific language governing permissions and
  20           * limitations under the License.
  21           */
  22          
  23          #include "ss881x.h"
  24          
  25          
  26          
  27          void adc_init()
  28          {  
  29   1              ADCCON0  |= 0x28;      /* ËøûÁª≠Ê®°Âºè,ADCÈááÊ†∑Êó∂Èíü1MHz,ADCÈááÊ†∑ÂêéÊª§Ê≥¢Ê±ÇÂùáÂÄºÊ†∑Êú¨‰∏™Êï∞
             -128 */      
  30   1              CLKCON1  |= 0x08;      /* ÈÄÅSCLKÁªôADC,ADCÊó∂Èíü‰ΩøËÉΩ */
  31   1              ADCCHEN   = 0x20;      /* AN5ÈÄöÈÅì‰ΩøËÉΩ */
  32   1              ADCCON3  &= ~(0x02);   /* ADCCCON3ÁöÑ bit1ÂÜô0 */
  33   1      }
  34          
  35          
  36          void data_i_read()
  37          {
  38   1              int   R = 1000;                         /*  ÈááÊ†∑ÁîµÈòªÁöÑÂÄº‰∏∫1Œ© */
  39   1              short  i_ma;
  40   1              i_ma    = ADCDAT5L;
  41   1              i_ma   += ((ADCDAT45H & 0xF0) << 4);
  42   1              i_ma  <<= 4;                            /* Â∑¶Áßª4‰ΩçÂÜçÂè≥Áßª4‰ΩçÔºåÂ∞Ü12‰ΩçË°•Á†ÅËΩ¨Êç¢Êàê16‰ΩçË
             -°•Á†Å */
  43   1              i_ma  >>= 4;
  44   1              i_ma    = i_ma / 36 / R;                 /* ÂÆûÈôÖËÆ°ÁÆóËøáÁ®ãÔºåÊ†πÊçÆRÂ§ßÂ∞èÁÆÄÂåñËÆ°ÁÆóËøáÁ®ã *
             -/
  45   1      }
  46          
  47          int main()
  48          {
  49   1              WDTCON  = 0x05;   /* ÂÖ≥Èó≠ÁúãÈó®Áãó */
  50   1              MFP2    = 0x0C;   /* p11 ‰Ωú‰∏∫ AN5 */
  51   1            
C51 COMPILER V9.57.0.0   MAIN                                                              11/23/2021 15:28:33 PAGE 2   

  52   1              adc_init();
  53   1          
  54   1              while(1) {
  55   2                 data_i_read();
  56   2              }
  57   1      }
  58          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    102    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
